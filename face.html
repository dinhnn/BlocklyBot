<html>
<div style="display:none">
   // rage
    function raging(){
      tl
        .to(lEye, .3, {
          delay: .3,
          morphSVG: rgLEye,
          strokeWidth: 3
        }, "-=.3")
        .to(rEye, .3, {
          morphSVG: rgREye,
          strokeWidth: 3
        }, "-=.3")
        .to(mouth, .3, {
          morphSVG: rgMouth
        }, "-=.3")
        .to([lEye, rEye, mouth], .3, {
          y: "-15px"
        })
        .to([lEye, rEye, mouth], .3, {
          delay: .6,
          y: "15px"
        })
        .to([lEye, rEye, mouth], .3, {
          y: "0"
        }, "-=.15")
        .to(lEye, .3, {
          morphSVG: {
            shape: stLEye,
            shapeIndex: 0
          },
          strokeWidth: 5
        })
        .to(rEye, .3, {
          morphSVG: stREye,
          strokeWidth: 5
        }, "-=.3")
        .to([lEye, rEye], .15, {
          scaleY: 0, transformOrigin: "center center",
        })
        .to([lEye, rEye], .15, {
          scaleY: 1
        })
    }
    
    // happy
    function happy(){
      tl
        .to(lEye, .3, {
          morphSVG: wkLEye,
          strokeWidth: 3
        })
        .to(rEye, .3, {
          morphSVG: wkREye,
          strokeWidth: 3
        }, "-=.3")
        .to(mouth, .3, {
          morphSVG: smMouth3
        }, "-=.3")
        .to([lEye, rEye, mouth], .3, {
          delay: .6,
          x: "-5px"
        })
        .to(lEye, .3, {
          morphSVG: hgLEye,
          strokeWidth: 5
        }, "-=.3")
        .to(lEye, .15, {
          delay: .6,
          scaleY: 0, transformOrigin: "center center",
        })
        .to(lEye, .15, {
          scaleY: 1
        })
        .to(hpLove, .3, {
          opacity: 1,
          x: "-7.5px"
        }, "-=.3")
        .to(hpLove, .3, {
          opacity: 0,
          y: "-7.5px"
        }, "-=.15")
        .to(lEye, .3, {
          delay: .6,
          morphSVG: wkLEye,
          strokeWidth: 3
        }, "-=.3")
        .to([lEye, rEye, mouth], .3, {
          delay: .6,
          x: "0px",
        })
        .set(hpLove, {
          x: "0px",
          y: "0px"
        })
    }
    
    // smAnim
    
    function smAnim(){
      tl
        .to(rEye, .3, {
          delay: .6,
          morphSVG: hgREye,
          strokeWidth: 5
        })
        .to(lEye, .3, {
          morphSVG: hgLEye,
          strokeWidth: 5
        }, "-=.3")
        .to(mouth, .3, {
          morphSVG: smMouth1
        }, "-=.3")
        .to([lEye, rEye], .15, {
          scaleY: 0, transformOrigin: "center center",
        })
        .to([lEye, rEye], .15, {
          scaleY: 1
        })
        .to([lEye, rEye], .15, {
          scaleY: 0, transformOrigin: "center center",
        })
        .to([lEye, rEye], .15, {
          scaleY: 1
        })
    }
    
    // wink
    function wink(){
      tl
        .to(lEye, .3, {
          morphSVG: hgLEye,
          strokeWidth: 5
        })
        .to(rEye, .3, {
          morphSVG: wkREye,
          strokeWidth: 3
        }, "-=.3")
        .to(mouth, .3, {
          morphSVG: smMouth1
        }, "-=.3")
        .to(mouth, .3, {
          morphSVG: smMouth2
        }, "-=.3")
    }
    
    // standardAnim
    function standardAnim(){
      tl
        .to([lEye, rEye], .15, {
          delay: .6,
          scaleY: 0, transformOrigin: "center center",
        })
        .to([lEye, rEye], .15, {
          scaleY: 1
        })
        .to([lEye, rEye], .15, {
          scaleY: 0, transformOrigin: "center center",
        })
        .to([lEye, rEye], .15, {
          scaleY: 1
        })
        .to([lEye, rEye, mouth], .3, {
          x: "-5px"
        })
        .to([lEye, rEye], .15, {
          scaleY: 0, transformOrigin: "center center",
        })
        .to([lEye, rEye], .15, {
          scaleY: 1
        })
        .to([lEye, rEye, mouth], .3, {
          x: "10px"
        })
        .to([lEye, rEye], .15, {
          scaleY: 0, transformOrigin: "center center",
        })
        .to([lEye, rEye], .15, {
          scaleY: 1
        })
        .to([lEye, rEye, mouth], .3, {
          x: "0px"
        })
    }
    
    // standard
    function standard(){
      tl
        .to(lEye, .3, {
          morphSVG: stLEye,
          strokeWidth: 5
        })
        .to(rEye, .3, {
          morphSVG: stREye,
          strokeWidth: 5
        }, "-=.3")
        .to(mouth, .3, {
          morphSVG: stMouth
        }, "-=.3")
    }
    
</div>
  <svg xmlns="http://www.w3.org/2000/svg" width="151" height="110" viewBox="0 0 151 110">
    <g id="Page-1" fill="none" fill-rule="evenodd">
      <rect id="face" x="0" y="0" width="151" height="110" fill="#000"/>
      <g id="face-components">
        <path id="wk-l-eye" stroke="#0F0" stroke-width="3" d="M55 59.12C55 54.7 51.418 51 47 51s-8 3.7-8 8.12" stroke-linecap="round"/>
        <path id="wk-r-eye" stroke="#0F0" stroke-width="3" d="M110 59c0-4.418-3.582-8.12-8-8.12s-8 3.702-8 8.12" stroke-linecap="round"/>
        <path id="sm-mouth-3" stroke="#0F0" stroke-width="3" d="M47.34 72.117s6.627 11.526 26.77 11.526 28.482-12.926 28.482-12.926" stroke-linecap="round"/>
        <path id="hp-love" fill="#F9767E" d="M32.72 45.607h.003L31.42 56.22l-10.612-1.303c-1.4-.167-2.735-.87-3.67-2.07-1.864-2.383-1.44-5.827.944-7.69 1.122-.878 2.48-1.248 3.797-1.146.2-1.34.893-2.608 2.045-3.508 2.384-1.863 5.828-1.44 7.69.945.96 1.226 1.313 2.733 1.106 4.16z"/>
        <path id="sm-mouth-2" stroke="#0F0" stroke-width="3" d="M57.786 79.82s12.038 6.573 26.507.926c14.47-5.647 17.3-18.03 17.3-18.03" stroke-linecap="round"/>
        <path id="sm-mouth-1" stroke="#0F0" stroke-width="3" d="M63.5 81.903s2.91 2.202 11.502 2.202c8.59 0 11.502-2.202 11.502-2.202" stroke-linecap="round"/>
        <path id="st-mouth" stroke="#0F0" stroke-width="3" d="M61.5 76.903h27.003" stroke-linecap="round"/>
        <path id="st-l-eye" stroke="#0F0" stroke-width="5" d="M47 63.5c1.38 0 2.5-1.12 2.5-2.503S48.38 58.5 47 58.5s-2.5 1.114-2.5 2.497c0 1.382 1.12 2.503 2.5 2.503z" stroke-linecap="round"/>
        <path id="st-r-eye" stroke="#0F0" stroke-width="5" d="M101.5 64c1.38 0 2.5-1.12 2.5-2.503S102.88 59 101.5 59 99 60.114 99 61.497C99 62.88 100.12 64 101.5 64z" stroke-linecap="round"/>
        <path id="hg-l-eye" stroke="#0F0" stroke-width="5" d="M47 53.5c1.38 0 2.5-1.12 2.5-2.503S48.38 48.5 47 48.5s-2.5 1.114-2.5 2.497c0 1.382 1.12 2.503 2.5 2.503z" stroke-linecap="round"/>
        <path id="hg-r-eye" stroke="#0F0" stroke-width="5" d="M101.5 54c1.38 0 2.5-1.12 2.5-2.503S102.88 49 101.5 49 99 50.114 99 51.497C99 52.88 100.12 54 101.5 54z" stroke-linecap="round"/>
        <path id="rg-mouth" stroke="#0F0" stroke-width="3" d="M60.9 79.478s4.24-3.546 13.496-3.546c9.255 0 14.503 3.546 14.503 3.546" stroke-linecap="round"/>
        <path id="rg-l-eye" stroke="#0F0" stroke-width="3" d="M39.5 57.5s4.85 1.294 8.11 2.665c3.26 1.372 6.89 3.335 6.89 3.335" stroke-linecap="round"/>
        <path id="rg-r-eye" stroke="#0F0" stroke-width="3" d="M108.5 57.5s-4.85 1.294-8.11 2.665C97.13 61.537 93.5 63.5 93.5 63.5" stroke-linecap="round"/>
        <path id="mouth" stroke="#0F0" stroke-width="3" d="M61.5 76.903h27.003" stroke-linecap="round"/>
        <path id="l-eye" stroke="#0F0" stroke-width="5" d="M47 63.5c1.38 0 2.5-1.12 2.5-2.503S48.38 58.5 47 58.5s-2.5 1.114-2.5 2.497c0 1.382 1.12 2.503 2.5 2.503z" stroke-linecap="round"/>
        <path id="r-eye" stroke="#0F0" stroke-width="5" d="M101.5 64c1.38 0 2.5-1.12 2.5-2.503S102.88 59 101.5 59 99 60.114 99 61.497C99 62.88 100.12 64 101.5 64z" stroke-linecap="round"/>
      </g>
    </g>
  </svg>
  <div id="canvas"></div>
  <script>
    var w = 151;
    var h = 800*w/480;
    var scale = w/151;//480.0/115.0;
    function drawEye(id,x,y,r,color,closed){
      closed = 1- (closed||0);
      var path = "M "+(x-r)+','+y+' C '
      +(x-r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y)+' '
      +(x+r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y)+' Z';
      return '<path id="face-'+id+'" fill="'+color+'" stroke="'+color+'" stroke-width="'+3*scale+'" d="'+path+'" stroke-linecap="round"/>\n';
    }
    function drawREye(id,box,left,color){
      var sx = 0.35;      
      var sy = 0.5;      
      var path;
      if(left){
        path = "M "+(box.x)+','+(box.y+box.h)+' C '
        +(box.x+box.w*sx)+','+(box.y+box.h-box.h*sy)+' '
        +(box.x+box.w-box.w*sy)+','+(box.y+box.h*sx)+' '
        +(box.x+box.w+box.w)+','+(box.y)+' '
        +(box.x+box.w-box.w*sy)+','+(box.y+box.h*sx)+' '
        +(box.x+box.w*sx)+','+(box.y+box.h-box.h*sy)+' '
        +(box.x)+','+(box.y+box.h)+' Z'
      } else {
        path = "M "+(box.x+box.w)+','+(box.y+box.h)+' C '
        +(box.x+box.w-box.w*sx)+','+(box.y+box.h-box.h*sy)+' '
        +(box.x+box.w*sy)+','+(box.y+box.h*sx)+' '
        +(box.x+box.w+box.w)+','+(box.y)+' '
        +(box.x+box.w*sy)+','+(box.y+box.h*sx)+' '
        +(box.x+box.w-box.w*sx)+','+(box.y+box.h-box.h*sy)+' '
        +(box.x+box.w)+','+(box.y+box.h)+' Z'
      }
      return '<path id="face-'+id+'" fill="'+color+'" stroke="'+color+'" stroke-width="'+3*scale+'" d="'+path+'" stroke-linecap="round"/>\n';
    }
    function drawWkEye(id,x,y,r,color,closed){
      closed = 1- (closed||0);
      var path = "M "+(x-r)+','+y+' C '
      +(x-r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y)+' '
      +(x+r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y)+' Z';
      return '<path id="face-'+id+'" fill="'+color+'" stroke="'+color+'" stroke-width="'+3*scale+'" d="'+path+'" stroke-linecap="round"/>\n';
    }

    function drawMouth(id,x,y,d,color,closed){
      var r = d/2;
      closed = 1- (closed||0);
      var path = "M "+(x-r)+','+y+' C '
      +(x-r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y)+' '
      +(x+r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y)+' Z';
      return '<path id="face-'+id+'" fill="'+color+'" stroke="'+color+'" stroke-width="'+3*scale+'" d="'+path+'" stroke-linecap="round"/>\n';
    }
    function drawSmMouth(id,x,y,d,color,closed){
      var r = d/2;
      closed = 1- (closed||0);
      var path = "M "+(x-r)+','+y+' C '
      +(x-r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y)+' '
      +(x+r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y+closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y)+' Z';
      return '<path id="face-'+id+'" fill="'+color+'" stroke="'+color+'" stroke-width="'+3*scale+'" d="'+path+'" stroke-linecap="round"/>\n';
    }
    function drawRMouth(id,x,y,d,color,closed){
      var r = d/2;
      closed = 1- (closed||0);
      var path = "M "+(x-r)+','+y+' C '
      +(x-r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x+r)+','+(y)+' '
      +(x+r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y-closed*4*Math.abs(r)/3)+' '
      +(x-r)+','+(y)+' Z';
      return '<path id="face-'+id+'" fill="'+color+'" stroke="'+color+'" stroke-width="'+3*scale+'" d="'+path+'" stroke-linecap="round"/>\n';
    }
    function drawWkMouth(id,box,color){
      var sx = 0.35;      
      var sy = 0.5;      
      var path = "M "+(box.x)+','+(box.y+box.h-box.h*sx)+' C '
      +(box.x+box.w*sy)+','+(box.y+box.h)+' '
      +(box.x+box.w-box.w*sx)+','+(box.y+box.h*sy)+' '
      +(box.x+box.w)+','+(box.y)+' '
      +(box.x+box.w-box.w*sx)+','+(box.y+box.h*sy)+' '
      +(box.x+box.w*sy)+','+(box.y+box.h)+' '
      +(box.x)+','+(box.y+box.h-box.h*sx)+' Z'

      return '<path id="face-'+id+'" fill="'+color+'" stroke="'+color+'" stroke-width="'+3*scale+'" d="'+path+'" stroke-linecap="round"/>\n';
    }
    function getBox(id){
      var path = document.getElementById(id);
      var sw = parseFloat(path.getAttribute('stroke-width'))-1;
      box = path.getBBox();      
      return {x:(box.x-sw/2)*scale,y:(box.y-sw/2)*scale,w:(box.width+sw)*scale,h:(box.height+sw)*scale};
    }
    console.log(getBox('r-eye'));
    reb = getBox('r-eye');
    var eyeR = reb.w/2;
    var eyeD = reb.x+reb.w/2-w/2;
    var eyeY = reb.y+reb.h/2;
    mb = getBox('mouth');
    var mouthY = mb.y+mb.h/2;
    var mouthD = mb.w;

    //standard
    svg='';
    svg+=drawEye('left_eye',w/2-eyeD,eyeY,-eyeR,'#0F0',0);
    svg+=drawEye('right_eye',w/2+eyeD,eyeY,eyeR,'#0F0',0);
    svg+=drawMouth('mouth',w/2,mouthY,mouthD,'#0F0',1);
    console.log('standard');
    console.log(svg);
    //standardAnim
    svg='';
    svg+=drawEye('left_eye',w/2-eyeD,eyeY,-eyeR,'#0F0',0);
    svg+=drawEye('right_eye',w/2+eyeD,eyeY,eyeR,'#0F0',0);
    svg+=drawMouth('mouth',w/2,mouthY,mouthD,'#0F0',1);

    svg+=drawEye('left_eye',w/2-eyeD,eyeY,-eyeR,'#0F0',1);
    svg+=drawEye('right_eye',w/2+eyeD,eyeY,eyeR,'#0F0',1);
    svg+=drawMouth('mouth',w/2,mouthY,mouthD,'#0F0',1);

    svg+=drawEye('left_eye',w/2-eyeD-5*scale,eyeY,-eyeR,'#0F0',0);
    svg+=drawEye('right_eye',w/2+eyeD-5*scale,eyeY,eyeR,'#0F0',0);
    svg+=drawMouth('mouth',w/2-5*scale,mouthY,mouthD,'#0F0',1);

    svg+=drawEye('left_eye',w/2-eyeD+5*scale,eyeY,-eyeR,'#0F0',0);
    svg+=drawEye('right_eye',w/2+eyeD+5*scale,eyeY,eyeR,'#0F0',0);
    svg+=drawMouth('mouth',w/2+5*scale,mouthY,mouthD,'#0F0',1);
    console.log('standardAnim');
    console.log(svg);
    //wink
    
    reb = getBox('hg-r-eye');
    var eyeR = reb.w/2;
    var eyeD = reb.x+reb.w/2-w/2;
    var eyeY = reb.y+reb.h/2;
    svg='';
    svg+=drawEye('left_eye',w/2-eyeD,eyeY,-eyeR,'#0F0',0);
    svg+=drawEye('right_eye',w/2+eyeD,eyeY,eyeR,'#0F0',0);
    reb = getBox('wk-r-eye');
    var eyeR = reb.w/2;
    var eyeD = reb.x+reb.w/2-w/2;
    var eyeY = reb.y+reb.h/2;
    
    //svg+=drawWkEye('right_eye',w/2+eyeD,eyeY,eyeR,'#0F0',0);
    mb = getBox('sm-mouth-1');

    var mouthY = mb.y+mb.h/2;
    var mouthD = mb.w;
    mb.h*=2;
    svg+=drawSmMouth('mouth',w/2,mouthY,mouthD,'#0F0',1-mb.h/mb.w);

    mb = getBox('sm-mouth-2');
    mb.h*=1.2;
    //svg+=drawWkMouth('mouth',mb,'#0F0');

    
    console.log('wink');
    console.log(svg);
    //raging

    svg='';
    svg+=drawREye('left_eye',getBox('rg-l-eye'),true,'#0F0',0);
    svg+=drawREye('right_eye',getBox('rg-r-eye'),false,'#0F0',0);
    mb = getBox('rg-mouth');
    mb.h*=2;
    var mouthY = mb.y+mb.h/2;
    var mouthD = mb.w;
    svg+=drawRMouth('mouth',w/2,mouthY,mouthD,'#0F0',1-mb.h/mb.w);

    
    console.log('raging');
    console.log(svg);

    svg = '<svg width="'+w+'" height="'+h+'" viewBox="0 0 '+w+' '+h+'"><rect x="0" y="0" width="'+w+'" height="'+h+'"/>'+svg+'</svg>';
    document.getElementById('canvas').innerHTML = svg;
    console.log(svg);    
  </script>
</html>
